<section class="comments-section">
  <div class="comments-header">
    <div>
      <p class="eyebrow">Community</p>
      <h3>Comments</h3>
    </div>
    <span class="badge">{{ comments.length }} {{ comments.length === 1 ? 'comment' : 'comments' }}</span>
  </div>

  <div *ngIf="authService.isAuthenticated(); else notAuthenticated" class="comment-form">
    <textarea
      [(ngModel)]="newComment"
      placeholder="Share your thoughts about this movie..."
      rows="3"
    ></textarea>
    <div class="form-actions">
      <small>Be respectful and keep it spoiler-free.</small>
      <button type="button" [disabled]="!newComment.trim()" (click)="submitComment()">Post comment</button>
    </div>
  </div>
  <ng-template #notAuthenticated>
    <div class="empty-state">
      <p>You must be logged in to add a comment.</p>
      <a routerLink="/login">Sign in</a>
    </div>
  </ng-template>

  <div *ngIf="comments.length > 0; else noComments" class="comment-list">
    <article class="comment-card" *ngFor="let comment of comments">
      <div class="avatar">{{ comment.user.name.charAt(0) }}</div>
      <div class="comment-body">
        <header>
          <strong>{{ comment.user.name }}</strong>
          <time>{{ comment.createdAt | date: 'mediumDate' }} â€¢ {{ comment.createdAt | date: 'shortTime' }}</time>
        </header>
        <p>{{ comment.content }}</p>
      </div>
    </article>
  </div>
  <ng-template #noComments>
    <div class="empty-state">
      <p>No comments yet. Be the first to start the conversation!</p>
    </div>
  </ng-template>
</section>
